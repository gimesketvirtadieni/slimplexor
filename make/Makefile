# SYNOPSIS:
#
#   make [all]       - compiles SlimPlexor
#   make clean       - removes all files generated by make except executable
#   make cleaneast   - removes all files generated by make including executable

BASE_DIRECTORY        = ..
SOURCES              += $(BASE_DIRECTORY)/src
HEADERS              += -I$(SOURCES)/src
SYMBOLS              +=
EXECUTABLE            = libasound_module_pcm_slimplexor.so

CXX                   = gcc
CXX_OPTIONS          += -c -O3 -fPIC -fmessage-length=0 -Wall
CXX_FLAGS            += $(SYMBOLS) $(HEADERS) $(CXX_OPTIONS)

LD_DIRECTORIES       +=
LD_LIBRARIES         += -lasound
LD_OPTIONS           += -s
LD_FLAGS             += $(LD_DIRECTORIES) $(LD_LIBRARIES) $(LD_OPTIONS)

# Default target executed when no arguments are given to make.
default_target: all

all : link clean

clean :
	rm -f *.o

cleanest : clean
	rm $(EXECUTABLE)

link : main func
	$(CXX) -shared -o $(EXECUTABLE) ./slimplexor.o func.o $(LD_FLAGS)

main :
	$(CXX) -o slimplexor.o $(SOURCES)/slimplexor.c $(CXX_FLAGS)

func :
	$(CXX) -o func.o $(SOURCES)/func.c $(CXX_FLAGS)
